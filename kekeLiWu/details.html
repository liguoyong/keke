<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>shopcar</title>
    <link rel="stylesheet" href="css/details.css">
</head>

<body>
    <div class="rightNav">
        <ul>
            <li>

            </li>
            <li>
                <a href="shopping_trolley.html">
                    </i>购物车</a>
            </li>
            <li>
                <a href="page.html">回到官网</a>
            </li>
            <li>
 
            </li>
            <li>

            </li>
        </ul>
        <span>
            <a href="##">
                <i class="iconfont icon-erweima"></i>
            </a>
            <a href="##" id="croll">top</a>
        </span>
    </div>
    <div class="header">
        <div class="top">
            <p>天猫首页</p>
            <p>
                <em>喵，欢迎来天猫</em>
                <a href="login.html" class="plaseSub">请登录</a>
                <a href="##" class="reg">免费注册</a>
            </p>
            <ul id="mTbao">
                <li>
                    <a href="##">我的淘宝
                        <b></b>
                    </a>

                </li>
                <li>
                    <a href="shopping_trolley.html">
                        <i class="iconfont icon-gouwuche"></i>购物车0件</a>

                </li>
                <li>
                    <a href="##">收藏夹
                        <b></b>
                    </a>

                </li>
                <li style="border-left:1px solid #999 ;"></li>
                <li>
                    <a href="##">
                        <i class="iconfont icon-shouji"></i>手机版</a>

                </li>
                <li>
                    <a href="##">淘宝网</a>
                </li>
                <li>
                    <a href="##">商家支持
                        <b></b>
                    </a>
                </li>
                <li>
                    <a href="##">
                        <i class="iconfont icon-daohang"></i>网站导航</a>

                </li>
            </ul>
        </div>
    </div>

    <div class="sear">
        <div class="search top">
            <img src="img/logo.png" />
            <div class="stopbox">
                <strong class="stopname">百草味旗舰店</strong>
                <span>品牌直销</span>
            </div>
            <div class="word">
                <a href="##">描述服务物流</a>
                <span>4.8&uarr;4.8&uarr;4.8&uarr;</span>
                <b></b>
            </div>
            <div class="code">
                <span>手机逛</span>
                <br/>
                <i class="iconfont icon-erweima"></i>
                <b></b>
            </div>
            <div class="search-right">
                <div class="ipt">
                    <input type="text" name="search" placeholder="搜索 天猫 商品/品牌/店铺" id="txt">

                    <button class="bta">搜天猫</button>
                    <ul class="tip">
                        <li>
                            <a href="##">百草味</a>
                        </li>
                        <li>
                            <a href="##">手撕面包</a>
                        </li>
                        <li>
                            <a href="##">休闲食品</a>
                        </li>
                        <li>
                            <a href="##">葡萄干</a>
                        </li>
                        <li>
                            <a href="##">免洗鸭脖礼包</a>
                        </li>
                    </ul>
                </div>
                <button class="btb">搜本店</button>

            </div>
        </div>
    </div>
    <div class="stopbanner">
        <!-- <div><img src="img/shops1.jpg" alt=""></div> -->
    </div>
    <div class="content top">
        <div class="glass_left">
            <div id="box">
                <img src="img/glass1-larger1.jpg" class="middle" />
                <div id="filter"></div>
            </div>
            <div id="max">
                <img src="img/glass1-larger1.jpg" id="maxImg">
            </div>

            <ul id="small">
                <li>
                    <img src="img/glass1-1.0.jpg" class="small" data-url="img/glass1-larger1.jpg">
                </li>
                <li>
                    <img src="img/glass1-1.1.jpg" class="small" data-url="img/glass1-larger2.jpg">
                </li>
                <li>
                    <img src="img/glass1-1.2.jpg" class="small" data-url="img/glass1-larger3.jpg">
                </li>
                <li>
                    <img src="img/glass1-1.3.jpg" class="small" data-url="img/glass1-larger4.jpg">
                </li>
                <li>
                    <img src="img/glass1-1.4.jpg" class="small" data-url="img/glass1-larger5.jpg">
                </li>
            </ul>
        </div>
        <div class="glass_center">
            <h1 class="htip">当时年少，谁不轻狂，青龙偃月，一把关刀闯四方,纵横捭阖。</h1>
            <div class="gray_box">
                <p class="p1">
                    <i>购物券</i>
                    <i>天猫</i>全天猫实物商品通用
                    <a>&gt;</a>
                    <span>去刮券</span>
                </p>
                <p class="p2">price:
                    <span>
                        <i>¥</i>
                        <em>189.00-839.00</em>
                    </span>
                </p>
                <p class="p3">
                    <span>促销价</span>
                    <em>
                        <i>¥</i>88.00-309.00 </em>
                </p>
            </div>
            <div class="place">
                <span>运费</span>
                <em>上海&nbsp;至&nbsp;深圳
                    <i>&or;</i>快递: 0.00</em>
            </div>
            <div class="sale">
                <span>月销量
                    <i>647</i>
                </span>
                <span>累计评价
                    <i>4331</i>
                </span>
                <span>送天猫积分
                    <i>8起</i>
                </span>
            </div>
            <div class="shop">
                <div class="shop_top">
                    <span>颜色分类</span>
                    <ul>
                        <li>
                            <img src="img/glass1-1.3.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_list2.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_large_list3.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_large_list4.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_large_list5.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_large_list3.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_large_list4.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_large_list3.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_large_list5.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_large_list3.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_large_list4.jpg">
                        </li>
                        <li>
                            <img src="img/glass1_large_list5.jpg">
                        </li>
                    </ul>
                </div>
                <div class="package">
                    <div class="package1">
                        <span>套餐类型</span>
                        <a href="##">官方标配</a>
                        <a href="##">套餐一</a>
                        <a href="##">套餐二</a>
                    </div>
                    <div class="package2">
                        <em>数量</em>
                        <input type="text" name="text" id="text" value="1">
                        <span id="up">∧</span>
                        <br/>
                        <span id="down">∨</span>
                        <i class="i1">件</i>
                        <i>库存4408件</i>
                    </div>
                    <div id="btn">
                        <button>立即购买</button>
                        <button id="shop_car">
                            <a href="shopping_trolley.html" class="addShop">加入购物车</a>
                        </button>
                    </div>
                    <div class="pledge">
                        <ul>
                            <li>服务承诺</li>
                            <li>正品保证</li>
                            <li>极速退款</li>
                            <li>赠运费险</li>
                            <li>七天无理由退换</li>
                            <li>支付方式 </li>
                        </ul>
                    </div>
                </div>

            </div>

        </div>
        <div class="glass_right">
            <div class="gright_hd">
                <s></s>
                <span>看了又看</span>
                <s></s>
            </div>
            <div class="gright_list">
                <ul>
                    <li>
                        <img src="https://img-tmdetail.alicdn.com/bao/uploaded///img.alicdn.com/bao/uploaded/TB1E5AlOVXXXXbEapXXXXXXXXXX_!!0-item_pic.jpg_160x160q90.jpg">
                        <a href="##">电脑主机组装机 DIY整机台式机游戏办公I5主机E5独显吃鸡I3主机</a>
                    </li>
                    <li>
                        <img src="https://img-tmdetail.alicdn.com/bao/uploaded///img.alicdn.com/bao/uploaded/TB1t605GXXXXXcFXXXXXXXXXXXX_!!0-item_pic.jpg_160x160q90.jpg">
                        <a href="##">电脑主机组装机 DIY整机台式机游戏办公I5主机E5独显吃鸡I3主机</a>
                    </li>
                    <li>
                        <img src="https://img-tmdetail.alicdn.com/bao/uploaded///img.alicdn.com/bao/uploaded/TB1LdFSlBDH8KJjy1zeXXXjepXa_!!0-item_pic.jpg_160x160q90.jpg">
                        <a href="##">电脑主机组装机 DIY整机台式机游戏办公I5主机E5独显吃鸡I3主机</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="capacity">
        <img src="images/capacity.png">
        <span></span>
    </div>
    <div class="ft top">
        <ul>
            <li>
                <p>
                    <a href="##">优</a>
                    <span>品质护航</span>
                    <em>购物无质护护质忧</em>
                </p>
            </li>
            <li>
                <p>
                    <a href="##">七</a>
                    <span>品质护航</span>
                    <em>购物质护质无忧</em>
                </p>
            </li>
            <li>
                <p>
                    <a href="##">特</a>
                    <span>品质护航</span>
                    <em>购物质质无忧</em>
                </p>
            </li>
            <li>
                <p>
                    <a href="##">帮</a>
                    <span>品质护航</span>
                    <em>购质物无忧</em>
                </p>
            </li>
        </ul>
    </div>

    <div class="ft_libox">
        <div class="ft_list top">
            <dl>
                <dt>
                    <span>购物指南</span>
                </dt>
                <a href="##">免费注册</a>
                <a href="##">开通支付宝</a>
                <a href="##">支付宝充值</a>
            </dl>
            <dl>
                <dt>
                    <span>天猫保障</span>
                </dt>
                <a href="##">发票保障</a>
                <a href="##">售后规则</a>
                <a href="##">缺货赔付</a>
            </dl>
            <dl>
                <dt>
                    <span>支付方式</span>
                </dt>
                <a href="##">快捷支付</a>
                <a href="##">信用卡</a>
                <a href="##">余额宝</a>
                <a href="##">蚂蚁花呗</a>
                <a href="##">货到付款</a>
            </dl>
            <dl>
                <dt>
                    <span>商家服务</span>
                </dt>
                <a href="##">天猫规则</a>
                <a href="##">商家中心</a>
                <a href="##">天猫智库</a>
                <a href="##">喵言喵语</a>
                <a href="##">货到付款</a>
                <a href="##">运营服务</a>
                <a href="##">天猫智库</a>
            </dl>
            <dl>
                <dt>
                    <span>手机天猫</span>
                </dt>
                <img src="images/code.png" alt="天猫" width="102px" height="102px">
            </dl>
        </div>
    </div>
    <div class="footer_box">
        <div class="footer top">
            <p>
                <a href="##">关于天猫</a>
                <a href="##">帮助中心</a>
                <a href="##">开放平台</a>
                <a href="##">诚聘英才</a>
                <a href="##">联系我们</a>
                <a href="##">网站合作</a>
                <a href="##">法律声明</a>
                <a href="##">隐私权政策</a>
                <a href="##">知识产权</a>
                <a href="##">廉正举报</a>
            </p>
            <p>
                <a href="##">阿里巴巴集团</a>
                <a href="##">淘宝网</a>
                <a href="##">天猫</a>
                <a href="##">聚划算</a>
                <a href="##">全球速卖通</a>
                <a href="##">帮助中心</a>
                <a href="##">开放平台</a>
                <a href="##">诚聘英才</a>
                <a href="##">联系我们</a>
                <a href="##">网站合作</a>
                <a href="##">阿里巴巴国际交易市场</a>
                <a href="##">1688</a>
                <a href="##">帮助中心</a>
                <a href="##">开放平台</a>
                <a href="##">诚聘英才</a>
                <a href="##">联系我们</a>
                <a href="##">网站合作</a>
                <a href="##">阿里妈妈 </a>
                <a href="##">飞猪</a>
                <a href="##">阿里云计算</a>
            </p>
            <span>
                <em>增值电信业务经营许可证:</em>
                <a href="##"> 浙B2-20110446 </a>
            </span>
            <span>
                <em>网络文化经营许可证：</em>
                <a href="##">浙网文[2015]0295-065号</a>
            </span>
            <span>
                <a href="##"> 12318举报</a>
            </span>
            <span>
                <em>出版物网络交易平台服务经营备案证：</em>
                <a href="##">新出发浙备字第001号</a>
            </span>
            <span>
                <em>互联网违法和不良信息举报电话：</em>
                <a href="##">0571-81683755</a>
            </span>
            <span>
                <a href="##"> blxxjb@alibaba-inc.com</a>
            </span>
            <span>
                <em>互联网药品信息服务资质证书编号：</em>
                <a href="##">浙-（经营性）-2017-0005</a>
            </span>
            <span>
                <em>浙公网安备</em>
                <a href="##">33010002000120号 </a>
            </span>
            <span>
                <a href="##">（浙）网械平台备字[2018]第00002号</a>
            </span>
            <span>
                <a href="##">© 2003-2018 TMALL.COM 版权所有</a>
            </span>
        </div>
    </div>
</body>

</html>
<script>

    function ajax() {
        //获取url地址的字符串
        var atr = location.search;
        // 然后字符串切割返回的是数组
        var num = atr.split('=')[1];
        // 取数组的第二个参数
        // 创建一个对象传递参数
        var _default = {
            method: 'GET', // 请求方式为GET,还有POST方式
            url: "php/gets.php?id=" + num, // 请求地址可通过字符串的拼接
            data: null, // 请求数据
            timeout: 1000,//定时器
            dataType: 'json',//数据类型是json格式
            success: function (json) {		//成功的回调函数，data是php返回的数据
                // console.log(json)
                var json = JSON.parse(json);
                //因为后台返回的是json字符串格式所以用JSON.parse()的方法转json对象，注：JSON.stringify()为json转字符串
                var data = json.data;
                // data为对象里面所需要用数据         
                if (data.pic) {
                    var pic = data.pic.split(',');
                    var allpic = data.all.split(',');

                    var glass_left = document.querySelector('.glass_left')
                    var ptr = "";
                    ptr = `
                        <div id="box">
                <img src=${allpic[0]} class="middle" />
                <div id="filter"></div>
            </div>
            <div id="max">
                <img src=${allpic[0]} id="maxImg">
            </div>
            <ul id="small">
                <li>
                    <img src=${pic[0]} class="small" data-url=${allpic[0]}>
                </li>
                <li>
                    <img src=${pic[1]} class="small" data-url=${allpic[1]}>
                </li>
                <li>
                    <img src=${pic[2]} class="small" data-url=${allpic[2]}>
                </li>
                <li>
                    <img src=${pic[3]} class="small" data-url=${allpic[3]}>
                </li>
                <li>
                    <img src=${pic[4]} class="small" data-url=${allpic[4]}>
                </li>
            </ul>`
                    glass_left.innerHTML = ptr;
                }

                var str = '', ktr = '', htr = '';
                var box = document.querySelector('#box');
                var stopName = document.querySelector('.stopname');
                var htip = document.querySelector('.htip');
                ktr = data.stops;
                htr = data.introduce;
                stopName.innerHTML = ktr;
                htip.innerHTML = htr;
            }
        }
        // console.log(_default.url);
        var xhr = new XMLHttpRequest;
        // if(_default.url.indexOf('?') == -1) {
        //             _default.url += '?' + Date.now();
        //         } else {
        //             _default.url += '&' + Date.now();
        //         }
        xhr.open(_default.method, _default.url, true);//创建请求
        xhr.send(null);//发送请求
        // 监听状态
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                // 获取的json数据为xhr的responseText字符串格式;
                var json = xhr.responseText;
                // 获取成功执行成功的回调函数
                _default.success(json);
                var glass = new fn();
            }
        }

    }
    ajax();
    //用户名插入
    
  
  
//加入购物车的个数
    function addShop(){
        this.txt = document.getElementById("text");               
        this.up = document.getElementById("up");
        this.down = document.getElementById("down");
        this.val = Number(this.txt.value);
        this.addcar = document.querySelector("#shop_car>.addShop");
        this.plaseSub = document.querySelector('.plaseSub');//获取登录位置
        this.reg = document.querySelector('.reg');//获取注册位置
        this.numObj = {};
        this.init();
    }
    addShop.prototype.init=function(){
        this.upoclick();
        this.downonclock();
        this.addShopcar();
        this.useradd();
    }
    //点击减减
    addShop.prototype.upoclick=function(){
        var _this = this;
        this.up.onclick = function(){
                    _this.val ++;
                    _this.txt.value = _this.val;
        }
    }
    //点击加加
    addShop.prototype.downonclock = function(){
        var _this = this;
        this.down.onclick = function(){
                         if(_this.txt.value<=1){
                            _this.txt.value = 1; 
                         }else{
                            _this.val --;
                        _this.txt.value = _this.val;
                         }                     
                    }
    }
    addShop.prototype.addShopcar = function(){
        var _this =this;
        this.addcar.onclick = function (ev) {
        var ev = ev || window.event;
        var target = ev.target || ev.srcElement;
        //事件委托的写法。得记住
        if (target.tagName == "A" && target.className == "addShop") {
            var atr = location.search;
            //获取url的id值
            var id = Number(atr.split('=')[1]);
            var n = _this.numObj[id];
            if (!n) {
                _this.numObj[id] = _this.txt.value;
            } else {
                n++;
                _this.numObj[id] = _this.txt.value;
            }
            var data = JSON.stringify(_this.numObj);
            // document.cookie =`init=${data}`;
            localStorage.setItem("init", data);
            var shop_num = localStorage.getItem("shop_num");
            //如果本地shop_num为空时执行
            if(!shop_num){
                localStorage.setItem("shop_num",id);
            }
           
            //没登录时，请先登录
            if(!localStorage.getItem("username")){
                this.href = "##";
                alert("请您，先登录~~");
            }
        }
    }          
    addShop.prototype.useradd = function(){
        var utr = location.search;
        var atr = localStorage.getItem('username');
        var id = Number(utr.split('=')[1]);
        if (atr) {
        this.plaseSub.innerHTML = atr;
        this.plaseSub.href = "##";
        this.plaseSub.style.color = "red";
        this.reg.innerHTML = "退出账号";
        this.reg.onclick = function () {
            localStorage.clear();
            location.href = "details.html?id="+id;
        }
    }
    }
    } 
  
var addShopfn = new addShop();


    //放大镜
    function fn() {
        this.oBox = document.getElementById("box");
        this.ofilter = document.getElementById("filter");
        this.opic = document.querySelectorAll(".small");
        this.middlePic = document.querySelector("#box>img");
        this.maxbox = document.getElementById("max");
        this.maxPic = document.querySelector("#max>img");
        this.init();
    }
    //初始化
    fn.prototype.init = function () {
        this.oBoxMouseover();
        this.oBoxMouseout();
        this.oBoxMousemove();
        this.oppic();
    }
    // //鼠标移入中盒子
    fn.prototype.oBoxMouseover = function () {
        var _this = this;
        this.oBox.onmouseover = function () {
            _this.obOver();
        }

    }
    //移入时透明盒子出现
    fn.prototype.obOver = function () {
        this.ofilter.style.display = "block";
        this.maxbox.style.display = "block";
    }
    //鼠标移出
    fn.prototype.oBoxMouseout = function () {
        var _this = this;
        this.oBox.onmouseout = function () {
            _this.oBout()
        }
    }
    //移出时透明盒子消失
    fn.prototype.oBout = function () {
        this.ofilter.style.display = "none";
        this.maxbox.style.display = "none";
    }
    //鼠标在中盒子移动
    fn.prototype.oBoxMousemove = function () {
        var _this = this;
        this.oBox.onmousemove = function () {
            _this.oBmove()
        }
    }
    //中盒子移动时，透明盒子范围
    fn.prototype.oBmove = function () {
        var e = e || event;
        var l = e.pageX - this.oBox.offsetLeft - this.ofilter.offsetWidth / 2;
        var t = e.pageY - this.oBox.offsetTop - this.ofilter.offsetHeight / 2;
        maxl = this.oBox.offsetWidth - this.ofilter.offsetWidth;
        maxt = this.oBox.offsetHeight - this.ofilter.offsetHeight;
        l = l > maxl ? maxl : (l < 0 ? 0 : l)
        t = t > maxt ? maxl : (t < 0 ? 0 : t)
        this.ofilter.style.left = l + "px";
        this.ofilter.style.top = t + "px";
        this.maxPic.style.left = -2 * l + 'px';
        this.maxPic.style.top = -2 * t + "px";
    }
    fn.prototype.oppic = function () {
        var _this = this;
        for (var i = 0; i < this.opic.length; i++) {
            this.opic[i].onmousedown = function () {
                _this.smpic(this);
            }
        }
    }
    fn.prototype.smpic = function (index) {
        var src = index.getAttribute("data-url");
        this.middlePic.src = src;
        console.log(this.middlePic.src);
        this.maxPic.src = src;

    }


</script>